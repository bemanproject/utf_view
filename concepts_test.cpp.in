module p2728:concepts_test;

import std_archetypes;
import :concepts;

namespace p2728 {

  static_assert(@*code-unit*@<char8_t>);
  static_assert(@*code-unit*@<char16_t>);
  static_assert(@*code-unit*@<char32_t>);
#ifdef WCHAR_T_IS_CODE_UNIT
  static_assert(@*code-unit*@<wchar_t>);
#ifdef CHAR_IS_CODE_UNIT
  static_assert(@*code-unit*@<char>);
#else
  static_assert(!@*code-unit*@<char>);
#endif
#else
  static_assert(!@*code-unit*@<wchar_t>);
#endif
  static_assert(!@*code-unit*@<int>);

  static_assert(
    @*utf-iter*@<
      std_archetypes::basic_input_iterator_archetype<
        char8_t, char8_t, char8_t const&>>);
  static_assert(
    @*utf-iter*@<
      std_archetypes::basic_input_iterator_archetype<
        char16_t, char16_t, char16_t const&>>);
  static_assert(
    @*utf-iter*@<
      std_archetypes::basic_input_iterator_archetype<
        char32_t, char32_t, char32_t const&>>);
#ifdef WCHAR_T_IS_CODE_UNIT
  static_assert(
    @*utf-iter*@<
      std_archetypes::basic_input_iterator_archetype<
        wchar_t, wchar_t, wchar_t const&>>);
#ifdef CHAR_IS_CODE_UNIT
  static_assert(
    @*utf-iter*@<
      std_archetypes::basic_input_iterator_archetype<
        char, char, char const&>>);
#else
  static_assert(
    !@*utf-iter*@<
      std_archetypes::basic_input_iterator_archetype<
        char, char, char const&>>);
#endif
#else
  static_assert(
    !@*utf-iter*@<
      std_archetypes::basic_input_iterator_archetype<
        wchar_t, wchar_t, wchar_t const&>>);
#endif
  static_assert(
    !@*utf-iter*@<
      std_archetypes::basic_input_iterator_archetype<
        int, int, int const&>>);

#ifdef CHARN_T_POINTERS_ARE_RANGE_LIKE
  static_assert(@*utf-pointer*@<char8_t*>);
  static_assert(@*utf-pointer*@<char16_t*>);
  static_assert(@*utf-pointer*@<char32_t*>);
#ifdef WCHAR_T_IS_CODE_UNIT
  static_assert(@*utf-pointer*@<wchar_t*>);
#ifdef CHAR_IS_CODE_UNIT
  static_assert(@*utf-pointer*@<char*>);
#else
  static_assert(!@*utf-pointer*@<char*>);
#endif
#else
  static_assert(!@*utf-pointer*@<wchar_t*>);
#endif
  static_assert(!@*utf-pointer*@<int*>);
#endif

// todo: utf-range tests

} // namespace p2728
